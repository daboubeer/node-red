var influxdb=function(t){"use strict";function e(){var t=new TextDecoder("utf-8");return{concat:function(t,e){var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r},copy:function(t,e,r){var n=new Uint8Array(r-e);return n.set(t.subarray(e,r)),n},toUtf8String:function(e,r,n){return t.decode(e.subarray(r,n))}}}function r(t,r){var n,o=null!=r?r:e(),i=!1,s=!1;return{next:function(e){if(!i)try{!function(e){var r,u=0;for(n?(e=o.concat(n,e),r=n.length):r=0;r<e.length;){var a=e[r];if(10===a){if(!s){var c=r>0&&13===e[r-1]?r-1:r;if(i)return;t.next(o.toUtf8String(e,u,c)),u=r+1}}else 34===a&&(s=!s);r++}n=u<r?o.copy(e,u,r):void 0}(e)}catch(t){this.error(t)}},error:function(e){i||(i=!0,t.error(e))},complete:function(){i||(n&&t.next(o.toUtf8String(n,0,n.length)),i=!0,t.complete())},useCancellable:function(e){if(t.useCancellable){var r=this;t.useCancellable({cancel:function(){e.cancel(),n=void 0,r.complete()},isCancelled:function(){return e.isCancelled()}})}}}}var n=function(){function t(){this._reuse=!1}return Object.defineProperty(t.prototype,"reuse",{get:function(){return this._reuse},set:function(t){t&&!this.reusedValues&&(this.reusedValues=new Array(10)),this._reuse=t},enumerable:!1,configurable:!0}),t.prototype.withReuse=function(){return this.reuse=!0,this},t.prototype.splitLine=function(t){if(null==t)return this.lastSplitLength=0,[];for(var e=0,r=0,n=this._reuse?this.reusedValues:[],o=0,i=0;i<t.length;i++){var s=t[i];if(","===s){if(e%2==0){var u=this.getValue(t,r,i,e);this._reuse?n[o++]=u:n.push(u),r=i+1,e=0}}else'"'===s&&e++}var a=this.getValue(t,r,t.length,e);return this._reuse?(n[o]=a,this.lastSplitLength=o+1):(n.push(a),this.lastSplitLength=n.length),n},t.prototype.getValue=function(t,e,r,n){return e===t.length?"":0===n?t.substring(e,r):2===n?t.substring(e+1,r-1):t.substring(e+1,r-1).replace(/""/gi,'"')},t}(),o=function(){};function i(){return new o}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function u(t,e){function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function c(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{a(n.next(t))}catch(t){i(t)}}function u(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,u)}a((n=n.apply(t,e||[])).next())}))}function l(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var f=[404,408,425,429,500,502,503,504];function h(t){return f.includes(t)}var p=function(t){function e(r){var n=t.call(this,r)||this;return n.name="IllegalArgumentError",Object.setPrototypeOf(n,e.prototype),n}return u(e,t),e}(Error),d=function(t){function e(r,n,o,i,s,u){var a=t.call(this)||this;if(a.statusCode=r,a.statusMessage=n,a.body=o,a.contentType=s,Object.setPrototypeOf(a,e.prototype),u)a.message=u;else if(o){if(null==s?void 0:s.startsWith("application/json"))try{a.json=JSON.parse(o),a.message=a.json.message,a.code=a.json.code}catch(t){}a.message||(a.message=r+" "+n+" : "+o)}else a.message=r+" "+n;return a.name="HttpError",a.setRetryAfter(i),a}return u(e,t),e.prototype.setRetryAfter=function(t){"string"==typeof t&&/^[0-9]+$/.test(t)?this._retryAfter=parseInt(t):this._retryAfter=0},e.prototype.canRetry=function(){return h(this.statusCode)},e.prototype.retryAfter=function(){return this._retryAfter},e}(Error),y=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE"];function v(t,e){if(t){var r=void 0;return"function"==typeof t.retryAfter?t.retryAfter():(r=0,e&&e>0?r+Math.round(Math.random()*e):r)}return 0}var m=function(t){function e(){var r=t.call(this)||this;return Object.setPrototypeOf(r,e.prototype),r.name="RequestTimedOutError",r.message="Request timed out",r}return u(e,t),e.prototype.canRetry=function(){return!0},e.prototype.retryAfter=function(){return 0},e}(Error),g=function(t){function e(){var r=t.call(this)||this;return r.name="AbortError",Object.setPrototypeOf(r,e.prototype),r.message="Response aborted",r}return u(e,t),e.prototype.canRetry=function(){return!0},e.prototype.retryAfter=function(){return 0},e}(Error),w=function(t){return t},b={boolean:function(t){return"true"===t},unsignedLong:function(t){return""===t?null:+t},long:function(t){return""===t?null:+t},double:function(t){switch(t){case"":return null;case"+Inf":return Number.POSITIVE_INFINITY;case"-Inf":return Number.NEGATIVE_INFINITY;default:return+t}},string:w,base64Binary:w,duration:function(t){return""===t?null:t},"dateTime:RFC3339":function(t){return""===t?null:t}};var x=function(){function t(t){t.forEach((function(t,e){return t.index=e})),this.columns=t}return t.prototype.column=function(t){for(var e=0;e<this.columns.length;e++){var r=this.columns[e];if(r.label===t)return r}throw new p("Column "+t+" not found!")},t.prototype.toObject=function(t){for(var e,r={},n=0;n<this.columns.length&&n<t.length;n++){var o=t[n],i=this.columns[n];""===o&&i.defaultValue&&(o=i.defaultValue),r[i.label]=(null!==(e=b[i.dataType])&&void 0!==e?e:w)(o)}return r},t}();function T(t){return new x(t)}function R(t){var e,r,o=(new n).withReuse(),s=!0,u=0;return{error:function(e){t.error(e)},next:function(n){if(""===n)s=!0,e=void 0;else{var a=o.splitLine(n),c=o.lastSplitLength;if(s){if(!e){e=new Array(c);for(var l=0;l<c;l++)e[l]=i()}if(a[0].startsWith("#")){if("#datatype"===a[0])for(l=1;l<c;l++)e[l].dataType=a[l];else if("#default"===a[0])for(l=1;l<c;l++)e[l].defaultValue=a[l];else if("#group"===a[0])for(l=1;l<c;l++)e[l].group="t"===a[l][0]}else{""===a[0]?(u=1,e=e.slice(1)):u=0;for(var l=u;l<c;l++)e[l-u].label=a[l];r=T(e),s=!1}}else t.next(a.slice(u,c),r)}},complete:function(){t.complete()},useCancellable:function(e){t.useCancellable&&t.useCancellable(e)}}}var O={retryJitter:200,minRetryDelay:5e3,maxRetryDelay:125e3,exponentialBase:5,randomRetry:!0},S={batchSize:1e3,flushInterval:6e4,writeFailed:function(){},writeSuccess:function(){},maxRetries:5,maxRetryTime:18e4,maxBufferLines:32e3,retryJitter:200,minRetryDelay:5e3,maxRetryDelay:125e3,exponentialBase:2,gzipThreshold:1e3,randomRetry:!0};function E(t,e){return function(r){for(var n="",o=0,i=0;i<r.length;){var s=t.indexOf(r[i]);s>=0&&(n+=r.substring(o,i),n+=e[s],o=i+1),i++}return 0==o?r:(o<r.length&&(n+=r.substring(o,r.length)),n)}}var D,C,A,_={measurement:E(", \n\r\t",["\\,","\\ ","\\n","\\r","\\t"]),quoted:(D='"\\',C=['\\"',"\\\\"],A=E(D,C),function(t){return'"'+A(t)+'"'}),tag:E(", =\n\r\t",["\\,","\\ ","\\=","\\n","\\r","\\t"])};var L=Date.now(),P=0;function B(){var t=Date.now();t!==L?(L=t,P=0):P++;var e=String(P);return String(t)+"000000000".substr(0,6-e.length)+e}function j(){return String(Date.now())+"000000000".substr(0,3)}function F(){return String(Date.now())}function I(){return String(Math.floor(Date.now()/1e3))}var M={s:I,ms:F,us:j,ns:B,seconds:I,millis:F,micros:j,nanos:B},N={s:function(t){return""+Math.floor(t.getTime()/1e3)},ms:function(t){return""+t.getTime()},us:function(t){return t.getTime()+"000"},ns:function(t){return t.getTime()+"000000"}};function k(t){return void 0===t?B():"string"==typeof t?t.length>0?t:void 0:t instanceof Date?t.getTime()+"000000":String("number"==typeof t?Math.floor(t):t)}var z={error:function(t,e){console.error("ERROR: "+t,e||"")},warn:function(t,e){console.warn("WARN: "+t,e||"")}},U=z,V={error:function(t,e){U.error(t,e)},warn:function(t,e){U.warn(t,e)}};var H=Symbol("FLUX_VALUE"),q=function(){function t(t){this.fluxValue=t}return t.prototype.toString=function(){return this.fluxValue},t.prototype[H]=function(){return this.fluxValue},t}();function W(t){return"object"==typeof t&&"function"==typeof t[H]}function J(t){if(null==t)return"";t=t.toString();var e=void 0,r=0;function n(){void 0===e&&(e=t.substring(0,r))}for(;r<t.length;r++){var o=t.charAt(r);switch(o){case"\r":n(),e+="\\r";break;case"\n":n(),e+="\\n";break;case"\t":n(),e+="\\t";break;case'"':case"\\":n(),e=e+"\\"+o;break;case"$":if(r+1<t.length&&"{"===t.charAt(r+1)){n(),r++,e+="\\${";break}null!=e&&(e+=o);break;default:null!=e&&(e+=o)}}return void 0!==e?e:t}function G(t){if("number"==typeof t){if(!isFinite(t))throw new Error("not a flux float: "+t);return t.toString()}for(var e=String(t),r=!1,n=0,o=e;n<o.length;n++){var i=o[n];if("."!==i){if("."!==i&&"-"!==i&&(i<"0"||i>"9"))throw new Error("not a flux float: "+e)}else{if(r)throw new Error("not a flux float: "+e);r=!r}}return e}function X(t){return'regexp.compile(v: "'+J(t)+'")'}function $(t){return new q(String(t))}function Y(t){if(void 0===t)return"";if(null===t)return"null";if("boolean"==typeof t)return t.toString();if("string"==typeof t)return'"'+J(t)+'"';if("number"==typeof t)return G(t);if("object"==typeof t){if("function"==typeof t[H])return t[H]();if(t instanceof Date)return t.toISOString();if(t instanceof RegExp)return X(t);if(Array.isArray(t))return"["+t.map(Y).join(",")+"]"}return Y(t.toString())}var K="function"==typeof Symbol&&Symbol.observable||"@@observable",Q=function(){function t(t){this.tags={},this.fields={},t&&(this.name=t)}return t.prototype.measurement=function(t){return this.name=t,this},t.prototype.tag=function(t,e){return this.tags[t]=e,this},t.prototype.booleanField=function(t,e){return this.fields[t]=e?"T":"F",this},t.prototype.intField=function(t,e){var r;if(r="number"==typeof e?e:parseInt(String(e)),isNaN(r)||r<=-0x8000000000000000||r>=0x8000000000000000)throw new Error("invalid integer value for field '"+t+"': '"+e+"'!");return this.fields[t]=Math.floor(r)+"i",this},t.prototype.uintField=function(t,e){if("number"==typeof e){if(isNaN(e)||e<0||e>Number.MAX_SAFE_INTEGER)throw new Error("uint value for field '"+t+"' out of range: "+e);this.fields[t]=Math.floor(e)+"u"}else{for(var r=String(e),n=0;n<r.length;n++){var o=r.charCodeAt(n);if(o<48||o>57)throw new Error("uint value has an unsupported character at pos "+n+": "+e)}if(r.length>20||20===r.length&&r.localeCompare("18446744073709551615")>0)throw new Error("uint value for field '"+t+"' out of range: "+r);this.fields[t]=r+"u"}return this},t.prototype.floatField=function(t,e){var r;if(r="number"==typeof e?e:parseFloat(e),!isFinite(r))throw new Error("invalid float value for field '"+t+"': "+e);return this.fields[t]=String(r),this},t.prototype.stringField=function(t,e){return null!=e&&("string"!=typeof e&&(e=String(e)),this.fields[t]=_.quoted(e)),this},t.prototype.timestamp=function(t){return this.time=t,this},t.prototype.toLineProtocol=function(t){var e=this;if(this.name){var r="";if(Object.keys(this.fields).sort().forEach((function(t){if(t){var n=e.fields[t];r.length>0&&(r+=","),r+=_.tag(t)+"="+n}})),0!==r.length){var n="",o=t&&t.defaultTags?a(a({},t.defaultTags),this.tags):this.tags;Object.keys(o).sort().forEach((function(t){if(t){var e=o[t];e&&(n+=",",n+=_.tag(t)+"="+_.tag(e))}}));var i=this.time;return i=t&&t.convertTime?t.convertTime(i):k(i),""+_.measurement(this.name)+n+" "+r+(void 0!==i?" "+i:"")}}},t.prototype.toString=function(){var t=this.toLineProtocol(void 0);return t||"invalid point: "+JSON.stringify(this,void 0)},t}(),Z=function(){function t(t){this.options=a(a({},O),t),this.success()}return t.prototype.nextDelay=function(t,e){var r=v(t);if(r&&r>0)return r+Math.round(Math.random()*this.options.retryJitter);if(e&&e>0){if(this.options.randomRetry){for(var n=Math.max(this.options.minRetryDelay,1),o=n*this.options.exponentialBase,i=1;i<e;i++)if(n=o,(o*=this.options.exponentialBase)>=this.options.maxRetryDelay){o=this.options.maxRetryDelay;break}return n+Math.round(Math.random()*(o-n)+Math.random()*this.options.retryJitter)}var s=Math.max(this.options.minRetryDelay,1);for(i=1;i<e;i++)if((s*=this.options.exponentialBase)>=this.options.maxRetryDelay){s=this.options.maxRetryDelay;break}return s+Math.round(Math.random()*this.options.retryJitter)}return this.currentDelay?this.currentDelay=Math.min(Math.max(this.currentDelay*this.options.exponentialBase,1)+Math.round(Math.random()*this.options.retryJitter),this.options.maxRetryDelay):this.currentDelay=this.options.minRetryDelay+Math.round(Math.random()*this.options.retryJitter),this.currentDelay},t.prototype.success=function(){this.currentDelay=void 0},t}();var tt=function(){function t(t,e){this.maxLines=t,this.retryLines=e,this.size=0,this.nextRetryTime=0,this.closed=!1,this._timeoutHandle=void 0}return t.prototype.addLines=function(t,e,r,n){if(!this.closed&&t.length){var o=Date.now()+r;if(n<o&&(r=n-Date.now(),o=n),o>this.nextRetryTime&&(this.nextRetryTime=o),this.first&&this.size+t.length>this.maxLines){var i=this.size,s=.7*i;do{var u=this.first.next;this.size-=this.first.lines.length,this.first.next=void 0,this.first=u,this.first||(this.last=void 0)}while(this.first&&this.size+t.length>s);V.error("RetryBuffer: "+(i-this.size)+" oldest lines removed to keep buffer size under the limit of "+this.maxLines+" lines")}var a={lines:t,retryCount:e,expires:n};this.last?(this.last.next=a,this.last=a):(this.first=a,this.last=a,this.scheduleRetry(r)),this.size+=t.length}},t.prototype.removeLines=function(){if(this.first){var t=this.first;return this.first=this.first.next,t.next=void 0,this.size-=t.lines.length,this.first||(this.last=void 0),t}},t.prototype.scheduleRetry=function(t){var e=this;this._timeoutHandle=setTimeout((function(){var t=e.removeLines();t?e.retryLines(t.lines,t.retryCount,t.expires).then((function(){e.scheduleRetry(1)})).catch((function(t){e.scheduleRetry(e.nextRetryTime-Date.now())})):e._timeoutHandle=void 0}),Math.max(t,0))},t.prototype.flush=function(){return c(this,void 0,void 0,(function(){var t;return l(this,(function(e){switch(e.label){case 0:return(t=this.removeLines())?[4,this.retryLines(t.lines,t.retryCount,t.expires)]:[3,2];case 1:return e.sent(),[3,0];case 2:return[2]}}))}))},t.prototype.close=function(){return this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=void 0),this.closed=!0,this.size},t}(),et=function(){function t(t,e,r){this.maxChunkRecords=t,this.flushFn=e,this.scheduleSend=r,this.length=0,this.lines=new Array(t)}return t.prototype.add=function(t){0===this.length&&this.scheduleSend(),this.lines[this.length]=t,this.length++,this.length>=this.maxChunkRecords&&this.flush().catch((function(t){}))},t.prototype.flush=function(){var t=this.reset();return t.length>0?this.flushFn(t):Promise.resolve()},t.prototype.reset=function(){var t=this.lines.slice(0,this.length);return this.length=0,t},t}(),rt=function(){function t(t,e,r,n,o){var i=this;this.transport=t,this.closed=!1,this._timeoutHandle=void 0,this.httpPath="/api/v2/write?org="+encodeURIComponent(e)+"&bucket="+encodeURIComponent(r)+"&precision="+n,this.writeOptions=a(a({},S),o),this.currentTime=M[n],this.dateToProtocolTimestamp=N[n],this.writeOptions.defaultTags&&this.useDefaultTags(this.writeOptions.defaultTags),this.sendOptions={method:"POST",headers:a({"content-type":"text/plain; charset=utf-8"},null==o?void 0:o.headers),gzipThreshold:this.writeOptions.gzipThreshold};var s;this.writeBuffer=new et(this.writeOptions.batchSize,(function(t){return i._clearFlushTimeout(),i.sendBatch(t,i.writeOptions.maxRetries+1)}),(function(){i.writeOptions.flushInterval>0&&(i._clearFlushTimeout(),i.closed||(i._timeoutHandle=setTimeout((function(){return i.sendBatch(i.writeBuffer.reset(),i.writeOptions.maxRetries+1).catch((function(t){}))}),i.writeOptions.flushInterval)))})),this.sendBatch=this.sendBatch.bind(this),this.retryStrategy=(s=this.writeOptions,new Z(s)),this.retryBuffer=new tt(this.writeOptions.maxBufferLines,this.sendBatch)}return t.prototype.sendBatch=function(t,e,r){var n=this;void 0===r&&(r=Date.now()+this.writeOptions.maxRetryTime);var o=this,i=o.writeOptions.maxRetries+2-e;if(!this.closed&&t.length>0){if(r<=Date.now()){var s=new Error("Max retry time exceeded.");return V.error("Write to InfluxDB failed (attempt: "+i+").",s),Promise.reject(s)}return new Promise((function(s,u){var a,c={responseStarted:function(t,e){a=e},error:function(n){var a=o.writeOptions.writeFailed.call(o,n,t,i);if(a)a.then(s,u);else{if(!o.closed&&e>1&&(!(n instanceof d)||n.statusCode>=429))return V.warn("Write to InfluxDB failed (attempt: "+i+").",n),o.retryBuffer.addLines(t,e-1,o.retryStrategy.nextDelay(n,i),r),void u(n);V.error("Write to InfluxDB failed.",n),u(n)}},complete:function(){if(204==a||null==a)o.writeOptions.writeSuccess.call(o,t),o.retryStrategy.success(),s();else{var e="204 HTTP response status code expected, but "+a+" returned",r=new d(a,e,void 0,"0");r.message=e,c.error(r)}}};n.transport.send(n.httpPath,t.join("\n"),n.sendOptions,c)}))}return Promise.resolve()},t.prototype._clearFlushTimeout=function(){void 0!==this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=void 0)},t.prototype.writeRecord=function(t){if(this.closed)throw new Error("writeApi: already closed!");this.writeBuffer.add(t)},t.prototype.writeRecords=function(t){if(this.closed)throw new Error("writeApi: already closed!");for(var e=0;e<t.length;e++)this.writeBuffer.add(t[e])},t.prototype.writePoint=function(t){if(this.closed)throw new Error("writeApi: already closed!");var e=t.toLineProtocol(this);e&&this.writeBuffer.add(e)},t.prototype.writePoints=function(t){if(this.closed)throw new Error("writeApi: already closed!");for(var e=0;e<t.length;e++){var r=t[e].toLineProtocol(this);r&&this.writeBuffer.add(r)}},t.prototype.flush=function(t){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this.writeBuffer.flush()];case 1:return e.sent(),t?[4,this.retryBuffer.flush()]:[3,3];case 2:return[2,e.sent()];case 3:return[2]}}))}))},t.prototype.close=function(){var t=this;return this.writeBuffer.flush().finally((function(){var e=t.retryBuffer.close();e&&V.error("Retry buffer closed with "+e+" items that were not written to InfluxDB!",null),t.closed=!0}))},t.prototype.dispose=function(){return this._clearFlushTimeout(),this.closed=!0,this.retryBuffer.close()+this.writeBuffer.length},t.prototype.useDefaultTags=function(t){return this.defaultTags=t,this},t.prototype.convertTime=function(t){return void 0===t?this.currentTime():"string"==typeof t?t.length>0?t:void 0:t instanceof Date?this.dateToProtocolTimestamp(t):String("number"==typeof t?Math.floor(t):t)},t}();function nt(t){var e={};return t.headers.forEach((function(t,r){var n=e[r];void 0===n?e[r]=t:Array.isArray(n)?n.push(t):e[r]=[n,t]})),e}var ot=function(){function t(t){this.connectionOptions=t,this.chunkCombiner=e(),this.requestDecorator=function(){},this.defaultHeaders={"content-type":"application/json; charset=utf-8"},this.connectionOptions.token&&(this.defaultHeaders.Authorization="Token "+this.connectionOptions.token),this.url=String(this.connectionOptions.url),this.url.endsWith("/")&&(this.url=this.url.substring(0,this.url.length-1)),this.url.endsWith("/api/v2")&&(this.url=this.url.substring(0,this.url.length-"/api/v2".length),V.warn("Please remove '/api/v2' context path from InfluxDB base url, using "+this.url+" !"))}return t.prototype.send=function(t,e,r,n){var o=this,i=function(t){void 0===t&&(t={});var e=0;return{next:function(r){0===e&&t.next&&null!=r&&t.next(r)},error:function(r){0===e&&(e=1,t.error&&t.error(r))},complete:function(){0===e&&(e=2,t.complete&&t.complete())},responseStarted:function(e,r){t.responseStarted&&t.responseStarted(e,r)}}}(n),s=!1,u=r.signal;if(n&&n.useCancellable){var f=new AbortController;u||(u=f.signal,r=a(a({},r),u)),n.useCancellable({cancel:function(){s=!0,f.abort()},isCancelled:function(){return s||u.aborted}})}this.fetch(t,e,r).then((function(t){return c(o,void 0,void 0,(function(){var e,r,o,s;return l(this,(function(u){switch(u.label){case 0:return(null==n?void 0:n.responseStarted)&&i.responseStarted(nt(t),t.status),t.status>=300?[2,t.text().then((function(e){if(!e){var r=t.headers.get("x-influxdb-error");r&&(e=r)}i.error(new d(t.status,t.statusText,e,t.headers.get("retry-after"),t.headers.get("content-type")))})).catch((function(e){V.warn("Unable to receive error body",e),i.error(new d(t.status,t.statusText,void 0,t.headers.get("retry-after"),t.headers.get("content-type")))}))]:[3,1];case 1:if(!t.body)return[3,6];e=t.body.getReader(),r=void 0,u.label=2;case 2:return[4,e.read()];case 3:r=u.sent(),i.next(r.value),u.label=4;case 4:if(!r.done)return[3,2];u.label=5;case 5:return[3,10];case 6:return t.arrayBuffer?[4,t.arrayBuffer()]:[3,8];case 7:return o=u.sent(),i.next(new Uint8Array(o)),[3,10];case 8:return[4,t.text()];case 9:s=u.sent(),i.next((new TextEncoder).encode(s)),u.label=10;case 10:return[2]}}))}))})).catch((function(t){s||i.error(t)})).finally((function(){return i.complete()}))},t.prototype.request=function(t,e,r,n){var o,i;return c(this,void 0,void 0,(function(){var s,u,a,c,f,h,p;return l(this,(function(l){switch(l.label){case 0:return[4,this.fetch(t,e,r)];case 1:return s=l.sent(),u=s.status,a=s.headers,c=a.get("content-type")||"",n&&n(nt(s),s.status),u>=300?[4,s.text()]:[3,3];case 2:throw(f=l.sent())||(h=a.get("x-influxdb-error"))&&(f=h),new d(u,s.statusText,f,s.headers.get("retry-after"),s.headers.get("content-type"));case 3:return(p=null!==(i=null===(o=r.headers)||void 0===o?void 0:o.accept)&&void 0!==i?i:c).includes("json")?[4,s.json()]:[3,5];case 4:return[2,l.sent()];case 5:return p.includes("text")||p.startsWith("application/csv")?[4,s.text()]:[3,7];case 6:return[2,l.sent()];case 7:return[2]}}))}))},t.prototype.fetch=function(t,e,r){var n=r.method,o=r.headers,i=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}(r,["method","headers"]),s=""+this.url+t,u=a({method:n,body:"GET"===n||"HEAD"===n?void 0:"string"==typeof e?e:JSON.stringify(e),headers:a(a({},this.defaultHeaders),o),credentials:"omit"},i);return this.requestDecorator(u,r,s),fetch(s,u)},t}(),it={header:!0,delimiter:",",quoteChar:'"',commentPrefix:"#",annotations:["datatype","group","default"]},st=function(){function t(t,e,r){this.transport=t,this.createCSVResponse=e,this.options="string"==typeof r?{org:r}:r}return t.prototype.with=function(e){return new t(this.transport,this.createCSVResponse,a(a({},this.options),e))},t.prototype.response=function(t){return this.createCSVResponse(this.createExecutor(t))},t.prototype.lines=function(t){return this.response(t).lines()},t.prototype.rows=function(t){return this.response(t).rows()},t.prototype.queryLines=function(t,e){return this.response(t).consumeLines(e)},t.prototype.queryRows=function(t,e){return this.response(t).consumeRows(e)},t.prototype.collectRows=function(t,e){return this.response(t).collectRows(e)},t.prototype.collectLines=function(t){return this.response(t).collectLines()},t.prototype.queryRaw=function(t){var e=this.options,r=e.org,n=e.type,o=e.gzip,i=e.headers;return this.transport.request("/api/v2/query?org="+encodeURIComponent(r),JSON.stringify(this.decorateRequest({query:t.toString(),dialect:it,type:n})),{method:"POST",headers:a({accept:"text/csv","accept-encoding":o?"gzip":"identity","content-type":"application/json; encoding=utf-8"},i)})},t.prototype.createExecutor=function(t){var e=this,r=this.options,n=r.org,o=r.type,i=r.gzip,s=r.headers;return function(r){e.transport.send("/api/v2/query?org="+encodeURIComponent(n),JSON.stringify(e.decorateRequest({query:t.toString(),dialect:it,type:o})),{method:"POST",headers:a({"content-type":"application/json; encoding=utf-8","accept-encoding":i?"gzip":"identity"},s)},r)}},t.prototype.decorateRequest=function(t){var e;return"function"==typeof this.options.now&&(t.now=this.options.now()),t.type=null!==(e=this.options.type)&&void 0!==e?e:"flux",t},t}(),ut=function(){function t(t,e){var r=this;this.isClosed=!1;try{e({next:function(e){t.next(e)},error:function(e){r.isClosed=!0,t.error(e)},complete:function(){r.isClosed=!0,t.complete()},useCancellable:function(t){r.cancellable=t}})}catch(e){this.isClosed=!0,t.error(e)}}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.isClosed},enumerable:!1,configurable:!0}),t.prototype.unsubscribe=function(){var t;null===(t=this.cancellable)||void 0===t||t.cancel(),this.isClosed=!0},t}();function at(){}var ct=function(){function t(t,e){this.executor=t,this.decorator=e}return t.prototype.subscribe=function(t,e,r){var n=function(t){var e=t.next,r=t.error,n=t.complete;return{next:e?e.bind(t):at,error:r?r.bind(t):at,complete:n?n.bind(t):at}}("object"!=typeof t||null===t?{next:t,error:e,complete:r}:t);return new ut(this.decorator(n),this.executor)},t.prototype[K]=function(){return this},t}();function lt(t,e){return e.toObject(t)}var ft=function(){function t(t,e){this.executor=t,this.chunkCombiner=e}return t.prototype.lines=function(){var t=this;return new ct(this.executor,(function(e){return r(e,t.chunkCombiner)}))},t.prototype.rows=function(){var t=this;return new ct(this.executor,(function(e){return r(R({next:function(t,r){e.next({values:t,tableMeta:r})},error:function(t){e.error(t)},complete:function(){e.complete()}}),t.chunkCombiner)}))},t.prototype.consumeLines=function(t){this.executor(r(t,this.chunkCombiner))},t.prototype.consumeRows=function(t){this.executor(r(R(t),this.chunkCombiner))},t.prototype.collectRows=function(t){var e=this;void 0===t&&(t=lt);var r=[];return new Promise((function(n,o){e.consumeRows({next:function(e,n){var o=t.call(this,e,n);void 0!==o&&r.push(o)},error:function(t){o(t)},complete:function(){n(r)}})}))},t.prototype.collectLines=function(){var t=this,e=[];return new Promise((function(r,n){t.consumeLines({next:function(t){e.push(t)},error:function(t){n(t)},complete:function(){r(e)}})}))},t}(),ht=function(){function t(t){var e,r=this;if("string"==typeof t)this._options={url:t};else{if(null===t||"object"!=typeof t)throw new p("No url or configuration specified!");this._options=t}var n=this._options.url;if("string"!=typeof n)throw new p("No url specified!");n.endsWith("/")&&(this._options.url=n.substring(0,n.length-1)),this.transport=null!==(e=this._options.transport)&&void 0!==e?e:new ot(this._options),this.processCSVResponse=function(t){return new ft(t,r.transport.chunkCombiner)}}return t.prototype.getWriteApi=function(t,e,r,n){return void 0===r&&(r="ns"),new rt(this.transport,t,e,r,null!=n?n:this._options.writeOptions)},t.prototype.getQueryApi=function(t){return new st(this.transport,this.processCSVResponse,t)},t}();return t.AbortError=g,t.DEFAULT_ConnectionOptions={timeout:1e4},t.DEFAULT_RetryDelayStrategyOptions=O,t.DEFAULT_WriteOptions=S,t.FLUX_VALUE=H,t.HttpError=d,t.IllegalArgumentError=p,t.InfluxDB=ht,t.LineSplitter=n,t.Log=V,t.Point=Q,t.RequestTimedOutError=m,t.canRetryHttpCall=function(t){return!!t&&("function"==typeof t.canRetry?!!t.canRetry():!(!t.code||!y.includes(t.code)))},t.chunksToLines=r,t.consoleLogger=z,t.convertTimeToNanos=k,t.createFluxTableColumn=function(t){var e,r,n=new o;return n.label=String(t.label),n.dataType=t.dataType,n.group=Boolean(t.group),n.defaultValue=null!==(e=t.defaultValue)&&void 0!==e?e:"",n.index=null!==(r=t.index)&&void 0!==r?r:0,n},t.createFluxTableMetaData=T,t.createTextDecoderCombiner=e,t.currentTime=M,t.dateToProtocolTimestamp=N,t.escape=_,t.flux=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(1==t.length&&0===e.length)return $(t[0]);for(var n=new Array(t.length+e.length),o=0,i=0;i<t.length;i++){var s=t[i];if(n[o++]=s,i<e.length){var u=e[i],a=void 0;if(s.endsWith('"')&&i+1<t.length&&t[i+1].startsWith('"'))a=J(u);else if(""===(a=Y(u))&&!W(u))throw new Error("Unsupported parameter literal '"+u+"' at index: "+i+", type: "+typeof u);n[o++]=a}else if(i<t.length-1)throw new Error("Too few parameters supplied!")}return $(n.join(""))},t.fluxBool=function(t){return new q("true"===t||"false"===t?t:(!!t).toString())},t.fluxDateTime=function(t){return new q(function(t){return'time(v: "'+J(t)+'")'}(t))},t.fluxDuration=function(t){return new q('duration(v: "'+J(t)+'")')},t.fluxExpression=$,t.fluxFloat=function(t){return new q(G(t))},t.fluxInteger=function(t){for(var e=G(t),r=0,n=e;r<n.length;r++){if("."===n[r])throw new Error("not a flux integer: "+e)}return new q(e)},t.fluxRegExp=function(t){return new q(X(t))},t.fluxString=function(t){return new q('"'+J(t)+'"')},t.getRetryDelay=v,t.isStatusCodeRetriable=h,t.linesToTables=R,t.newFluxTableColumn=i,t.sanitizeFloat=G,t.serializeDateTimeAsDate=function(){b["dateTime:RFC3339"]=function(t){return""===t?null:new Date(Date.parse(t))}},t.serializeDateTimeAsNumber=function(){b["dateTime:RFC3339"]=function(t){return""===t?null:Date.parse(t)}},t.serializeDateTimeAsString=function(){b["dateTime:RFC3339"]=function(t){return""===t?null:t}},t.setLogger=function(t){var e=U;return U=t,e},t.stringToLines=function(t,e){for(var r=!1,n=0,o=0;o<t.length;){var i=t.charCodeAt(o);if(10===i){if(!r){var s=o>0&&13===t.charCodeAt(o-1)?o-1:o;e.next(t.substring(n,s)),n=o+1}}else 34===i&&(r=!r);o++}n<o&&e.next(t.substring(n,o)),e.complete()},t.symbolObservable=K,t.toFluxValue=Y,t.typeSerializers=b,t.useProcessHrtime=function(t){return!1},Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=influxdb.min.js.map
